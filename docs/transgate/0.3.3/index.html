<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Agent.html">Agent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Agent.html#.all">all</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Agent.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Agent.html#after">after</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Agent.html#before">before</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Agent.html#main">main</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="HttpClientGate.html">HttpClientGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HttpClientGate.html#send">send</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="HttpServerGate.html">HttpServerGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HttpServerGate.html#close">close</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="HttpServerGate.html#receive">receive</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ItemBuffer.html">ItemBuffer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ItemBuffer.html#read">read</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ItemBuffer.html#write">write</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="JointGate.html">JointGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="JointGate.html#receive">receive</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="JointGate.html#send">send</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="MemoryGate.html">MemoryGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MemoryGate.html#receive">receive</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MemoryGate.html#send">send</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ReadFileGate.html">ReadFileGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReadFileGate.html#_parse">_parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReadFileGate.html#receive">receive</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ReadLineStreamGate.html">ReadLineStreamGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReadLineStreamGate.html#_parse">_parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ReadLineStreamGate.html#receive">receive</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="StdinGate.html">StdinGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="StdinGate.html#_parse">_parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="StdinGate.html#receive">receive</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="StdoutGate.html">StdoutGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="StdoutGate.html#_stringify">_stringify</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="StdoutGate.html#send">send</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="WriteFileGate.html">WriteFileGate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="WriteFileGate.html#_stringify">_stringify</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="WriteFileGate.html#send">send</a></span></li>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>Transgate</h1><p><a href="https://www.npmjs.com/package/transgate"><img src="https://img.shields.io/npm/v/transgate.svg" alt="npm"></a>
<a href=""><img src="https://img.shields.io/node/v/transgate.svg" alt="Node"></a>
<a href="https://tilfin.github.io/transgate/transgate/0.3.0/"><img src="https://img.shields.io/badge/document-0.3.0-orange.svg" alt="document"></a>
<a href=""><img src="https://img.shields.io/github/license/tilfin/transgate.svg" alt="License"></a>
<a href="https://david-dm.org/tilfin/transgate"><img src="https://david-dm.org/tilfin/transgate/status.svg" alt="dependencies Status"></a>
<a href="https://travis-ci.org/tilfin/transgate"><img src="https://travis-ci.org/tilfin/transgate.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/github/tilfin/transgate?branch=master"><img src="https://coveralls.io/repos/github/tilfin/transgate/badge.svg?branch=master" alt="Coverage Status"></a></p>
<p>Agent-based task flow framework for Node.js</p>
<h2>Install</h2><pre class="prettyprint source"><code>npm install -save transgate</code></pre><h2>Actors in this framework</h2><ul>
<li><strong>Gate</strong> is an endpoint of Input/Output. For example, file storage, database, queue or API service.</li>
<li><strong>Agent</strong> is a worker to process an <strong>item</strong> between Input/Output <strong>gates</strong> and does not know anything opposite <strong>gates</strong>.</li>
<li><strong>Item</strong> is an entity as each task target, to be exchanged between <strong>gates</strong>, and an <em>Object</em> or a <em>JSON</em>. <code>null</code> indicates the terminator.</li>
</ul>
<h2>How it works</h2><ol>
<li>A <strong>agent</strong> receives an <strong>item</strong> from a <strong>gate</strong> for Input.</li>
<li>The <strong>agent</strong> processes an <strong>item</strong>.</li>
<li>According to need the <strong>Agent</strong> sends the results as next <strong>item(s)</strong> to some gate(s) for Output.</li>
</ol>
<p>If the <strong>agent</strong> receives <code>null</code> as an <strong>item</strong>, sends <code>null</code> to all next <strong>gates</strong> and closes itself.</p>
<ul>
<li>All agents must be given gates for input and output in the constructor and run independently.</li>
<li>A gate is easy to replace because the interface of the item is a simple <em>Object</em>.</li>
</ul>
<h2>Implements</h2><h3>Gate</h3><ul>
<li>A gate for Input must implement <code>receive</code> <em>Promise</em> method that resolves an <strong>item</strong>.</li>
<li>A gate for Output must implement <code>send</code> <em>Promise</em> method with argument an <strong>item</strong>. <code>send</code> resolves when completes to write the item.</li>
</ul>
<h3>Agent</h3><ul>
<li>An agent inherits <code>Agent</code> class and overrides <code>async main(item, outGate)</code> method to process an <code>item</code> and send it to <code>outGate</code>.</li>
<li>To create an agent instance is to call <code>new YourAgent(inGate, outGate)</code>. If the <code>outGate</code> is plural, it need be replaced with key-value-based <code>{ outGate1, outGate2 }</code> in order to have <code>async main(item, { outGate1, outGate2 })</code>.</li>
<li>If the agent uses any daemon, overrides <code>async before()</code> to launch it and <code>async after()</code> to shut down it.</li>
</ul>
<h3>Starting</h3><p>To start agents is calling <code>Agent.all(...yourAgents)</code> <em>Promise</em> method. If you use any daemons in some gates, They should be shut down after <code>all</code> <em>Promise</em> has done.</p>
<h2>Standard Gate classes</h2><p>There are the following gates in this library.</p>
<ul>
<li>MemoryGate - Supports both Input/Output for test</li>
<li>ReadFileGate - Reading each line as an item from a file for Input</li>
<li>WriteFileGate - Writing sended items to a file for Output</li>
<li>HttpServerGate - Receiving an item that is a body POSTed by HTTP client for Input</li>
<li>HttpClientGate - Sending an item as POST request body to fixed HTTP server endpoint for Output</li>
<li>StdinGate - Reading each line as an item from stdin for Input</li>
<li>StdoutGate - Writing sended items to stdout for Output</li>
<li>JointGate - Pipes an agent to another one</li>
</ul>
<h2>An example</h2><h3>About agents</h3><ol>
<li>(No name)   : item.value x 2</li>
<li><code>ValueAdd1</code> : item.value + 1</li>
</ol>
<h3>About connections between agent and gates</h3><ul>
<li>memory --&gt; Agent1 --&gt; joint</li>
<li>joint  --&gt; Agent2 --&gt; stdout</li>
</ul>
<pre class="prettyprint source lang-javascript"><code>const {
  Agent,
  JointGate,
  MemoryGate,
  StdoutGate,
} = require('transgate');

class ValueAdd1 extends Agent {
  async main(item, stdoutGate) {
    item.value += 1;
    stdoutGate.send(item);
  }
}

const inputGate = new MemoryGate([
  { value: 1 }, { value: 2 }, { value: 3 }, { value: 4 }
]);
const joint = new JointGate();
const stdoutGate = new StdoutGate();

Agent.all(
  Agent.create(inputGate, joint, async (item) => {
    item.value *= 2;
    return item;
  }),
  new ValueAdd1(joint, stdoutGate),
)
.catch(err => {
  console.error(err);
});</code></pre><h4>The result stdout</h4><pre class="prettyprint source lang-json"><code>{&quot;value&quot;:3}
{&quot;value&quot;:5}
{&quot;value&quot;:7}
{&quot;value&quot;:9}</code></pre></article>
    </section>






</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Nov 19 2017 15:36:09 GMT+0900 (JST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>